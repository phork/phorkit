import { cx } from '@emotion/css';
import { Canvas, Meta } from '@storybook/addon-docs';
import { SearchIcon } from 'icons/SearchIcon';
import { Button, ButtonGroup } from 'components/Button';
import { Flex } from 'components/Flex';
import { Rhythm } from 'components/Rhythm';
import { Typography } from 'components/Typography';
import { Dropdown } from 'compositions/Dropdown';
import { StateWrapper } from 'docs/helpers/StateWrapper';
import {
  Checkbox,
  CheckboxGroup,
  Label,
  Password,
  Radio,
  RadioGroup,
  Select,
  Slider,
  Stepper,
  Textarea,
  Textbox,
  Toggle,
} from '../index';
import { FormDemo } from './helpers/FormDemo';

<Meta
  parameters={{
    viewMode: 'docs',
    previewTabs: {
      canvas: { hidden: true },
    },
  }}
  title="Form/All components"
/>

<Typography as="h1" heading="h1" style={{ fontSize: 48, marginBottom: 16 }} weight="lighter">
  All form components
</Typography>

<Canvas>
  <StateWrapper initialState={{ variant: 'underline', size: 'large' }}>
    {({ state, setState }) => (
      <Rhythm grouped mx={3}>
        <FormDemo contrast={false} style={{ maxWidth: '400px' }}>
          {({ contrast = false, handleChange: onChange, options, persistEvents, refs, setValues, values }) => (
            <React.Fragment>
              <Rhythm mb={2} mt={4}>
                <ButtonGroup
                  fullWidth
                  align="center"
                  buttons={[
                    { id: 'underline', label: 'Underline', selected: state.variant === 'underline' },
                    { id: 'filled', label: 'Filled', selected: state.variant === 'filled' },
                    { id: 'outline', label: 'Outline', selected: state.variant === 'outline' },
                  ]}
                  color="primary"
                  onClick={(event, id) => setState({ ...state, variant: id })}
                  shape="brick"
                  spacing="joined"
                />
              </Rhythm>
              <Rhythm mb={2} mt={4}>
                <ButtonGroup
                  fullWidth
                  align="center"
                  buttons={[
                    { id: 'medium', label: 'M', selected: state.size === 'medium' },
                    { id: 'large', label: 'L', selected: state.size === 'large' },
                    { id: 'xlarge', label: 'XL', selected: state.size === 'xlarge' },
                    { id: '2xlarge', label: '2XL', selected: state.size === '2xlarge' },
                    { id: '3xlarge', label: '3XL', selected: state.size === '3xlarge' },
                    { id: '4xlarge', label: '4XL', selected: state.size === '4xlarge' },
                    { id: '5xlarge', label: '5XL', selected: state.size === '5xlarge' },
                    { id: '6xlarge', label: '6XL', selected: state.size === '6xlarge' },
                    { id: '7xlarge', label: '7XL', selected: state.size === '7xlarge' },
                    { id: '8xlarge', label: '8XL', selected: state.size === '8xlarge' },
                  ]}
                  color="neutral"
                  onClick={(event, id) => setState({ ...state, size: id })}
                  selectedColor="primary"
                  selectedWeight="inline"
                  shape="brick"
                  size="small"
                  spacing="cozy"
                  weight="inline"
                />
              </Rhythm>
              <Rhythm my={2}>
                <Textbox
                  transitional
                  contrast={contrast}
                  label="Username"
                  name="username"
                  onChange={onChange}
                  persistEvents={persistEvents}
                  ref={e => {
                    refs.current.username = e;
                  }}
                  size={state.size}
                  value={values.username}
                  variant={state.variant}
                />
              </Rhythm>
              <Rhythm my={2}>
                <Password
                  transitional
                  contrast={contrast}
                  label="Password"
                  name="password"
                  onChange={onChange}
                  persistEvents={persistEvents}
                  ref={e => {
                    refs.current.password = e;
                  }}
                  size={state.size}
                  value={values.password}
                  variant={state.variant}
                />
              </Rhythm>
              <Rhythm my={2}>
                <Textbox
                  clearable
                  transitional
                  contrast={contrast}
                  iconBefore={<SearchIcon />}
                  label="Search"
                  name="search"
                  onChange={onChange}
                  onClear={() => setValues({ ...values, search: '' })}
                  persistEvents={persistEvents}
                  ref={e => {
                    refs.current.search = e;
                  }}
                  size={state.size}
                  value={values.search}
                  variant={state.variant}
                />
              </Rhythm>
              <Rhythm my={2}>
                <Textbox
                  transitional
                  contrast={contrast}
                  label="Successful"
                  name="success"
                  onChange={onChange}
                  persistEvents={persistEvents}
                  ref={e => {
                    refs.current.success = e;
                  }}
                  size={state.size}
                  validity="success"
                  value={values.success}
                  variant={state.variant}
                />
              </Rhythm>
              <Rhythm my={2}>
                <Textbox
                  transitional
                  contrast={contrast}
                  label="Warningish"
                  name="warning"
                  onChange={onChange}
                  persistEvents={persistEvents}
                  ref={e => {
                    refs.current.warning = e;
                  }}
                  size={state.size}
                  validity="warning"
                  value={values.warning}
                  variant={state.variant}
                />
              </Rhythm>
              <Rhythm my={2}>
                <Textbox
                  transitional
                  contrast={contrast}
                  label="Dangerous"
                  name="danger"
                  onChange={onChange}
                  persistEvents={persistEvents}
                  ref={e => {
                    refs.current.danger = e;
                  }}
                  size={state.size}
                  validity="danger"
                  value={values.danger}
                  variant={state.variant}
                />
              </Rhythm>
              <Rhythm my={2}>
                <Select
                  transitional
                  contrast={contrast}
                  label="Choose a color"
                  name="selectColor"
                  onChange={onChange}
                  options={options}
                  persistEvents={persistEvents}
                  ref={e => {
                    refs.current.selectColor = e;
                  }}
                  size={state.size}
                  value={values.selectColor}
                  variant={state.variant}
                />
              </Rhythm>
              <Rhythm my={2}>
                <Select
                  transitional
                  contrast={contrast}
                  label="Choose another color"
                  name="selectAnotherColor"
                  onChange={onChange}
                  options={options}
                  persistEvents={persistEvents}
                  ref={e => {
                    refs.current.selectAnotherColor = e;
                  }}
                  size={state.size}
                  value={values.selectAnotherColor}
                  variant={state.variant}
                />
              </Rhythm>
              <Rhythm my={2}>
                <Dropdown
                  transitional
                  inputVariant={state.variant}
                  label="A custom dropdown"
                  layout="raised"
                  onChange={value => onChange({ target: { name: 'dropdown' } }, value)}
                  options={options}
                  ref={e => {
                    refs.current.dropdown = e && e.container;
                  }}
                  size={state.size}
                />
              </Rhythm>
              <Rhythm mb={2} mt={4}>
                <Dropdown
                  transitional
                  inputVariant={state.variant}
                  label="A contained dropdown"
                  layout="contained"
                  onChange={value => onChange({ target: { name: 'dropdownContained' } }, value)}
                  options={options}
                  ref={e => {
                    refs.current.dropdownContained = e && e.container;
                  }}
                  size={state.size}
                />
              </Rhythm>
              <Rhythm my={2}>
                <Textarea
                  transitional
                  contrast={contrast}
                  label="Manifesto"
                  name="textarea"
                  onChange={onChange}
                  persistEvents={persistEvents}
                  ref={e => {
                    refs.current.textarea = e;
                  }}
                  size={state.size}
                  value={values.textarea}
                  variant={state.variant}
                />
              </Rhythm>
              <Rhythm my={2}>
                <Checkbox
                  checked={!!values.checkbox}
                  contrast={contrast}
                  name="checkbox"
                  onChange={(event, checked) => setValues({ ...values, checkbox: checked })}
                  persistEvents={persistEvents}
                  ref={e => {
                    refs.current.checkbox = e;
                  }}
                  size={state.size}
                  variant="secondary"
                >
                  Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer eget dui eu orci ultrices maximus eu
                  eu ante. Vestibulum ligula velit, scelerisque vitae venenatis tempor, consectetur a orci. Aenean
                  molestie eu tortor in pharetra. Nulla lobortis, sapien quis ornare venenatis, nunc libero finibus
                  justo, non tempor nisi urna quis justo. Integer sit amet venenatis leo.
                </Checkbox>
              </Rhythm>
              <Rhythm mr={2} my={2}>
                <Radio
                  checked={values.radio === 'one'}
                  contrast={contrast}
                  name="radio"
                  onChange={(event, checked, value) => checked && setValues({ ...values, radio: value })}
                  persistEvents={persistEvents}
                  ref={e => {
                    refs.current.radio1 = e;
                  }}
                  size={state.size}
                  value="one"
                  variant="secondary"
                >
                  Lorem ipsum dolor sit amet
                </Radio>
                <Radio
                  checked={values.radio === 'two'}
                  contrast={contrast}
                  name="radio"
                  onChange={(event, checked, value) => checked && setValues({ ...values, radio: value })}
                  persistEvents={persistEvents}
                  ref={e => {
                    refs.current.radio2 = e;
                  }}
                  size={state.size}
                  value="two"
                  variant="secondary"
                >
                  Consectetur adipiscing elit
                </Radio>
              </Rhythm>
              <Rhythm grouped mb={2} mt={4}>
                <Flex flexible alignItems="flex-end" direction="row" justifyContent="space-between">
                  <div>
                    <Label as="legend" contrast={contrast} strength="legend">
                      Pick a big number
                    </Label>
                    <Stepper
                      contrast={contrast}
                      inputWidth={100}
                      max={10000}
                      min={0}
                      name="stepper1"
                      onChange={(event, value) => setValues({ ...values, stepper1: value })}
                      persistEvents={persistEvents}
                      ref={e => {
                        refs.current.stepper1 = e;
                      }}
                      size={state.size}
                      step={100}
                      value={values.stepper1}
                      variant={state.variant}
                      width="50%"
                    />
                  </div>
                  <Stepper
                    contrast={contrast}
                    inputWidth={100}
                    label="Pick another number"
                    max={100}
                    min={0}
                    name="stepper2"
                    onChange={(event, value) => setValues({ ...values, stepper2: value })}
                    persistEvents={persistEvents}
                    ref={e => {
                      refs.current.stepper2 = e;
                    }}
                    size={state.size}
                    step={10}
                    value={values.stepper2}
                    variant={state.variant}
                    width="50%"
                  />
                </Flex>
              </Rhythm>
              <Rhythm mb={2} mt={4}>
                <CheckboxGroup
                  checkboxes={[
                    {
                      id: 'demo-checkbox-group1',
                      label: 'Super fantastic label one',
                      name: 'checkboxes1',
                      ref: refs.current.checkboxes1,
                      value: 'one',
                    },
                    {
                      id: 'demo-checkbox-group2',
                      label: 'Super fantastic label two',
                      name: 'checkboxes2',
                      ref: refs.current.checkboxes2,
                      value: 'two',
                    },
                    {
                      id: 'demo-checkbox-group3',
                      label: 'Super fantastic label three',
                      name: 'checkboxes3',
                      ref: refs.current.checkboxes3,
                      value: 'three',
                    },
                  ]}
                  contrast={contrast}
                  layout="stacked"
                  legend="Super fantastic label"
                  name="checkboxes"
                  onChange={(event, value) => setValues({ ...values, checkboxes: value })}
                  size={state.size}
                  values={values.checkboxes}
                />
              </Rhythm>
              <Rhythm mb={2} mt={4}>
                <RadioGroup
                  contrast={contrast}
                  layout="inline"
                  legend="Super fantastic label"
                  name="radios"
                  onChange={(event, value) => setValues({ ...values, radios: value })}
                  radios={[
                    {
                      id: 'demo-radio-group1',
                      label: 'Super fantastic label one',
                      ref: refs.current.radios1,
                      value: 'one',
                    },
                    {
                      id: 'demo-radio-group2',
                      label: 'Super fantastic label two',
                      ref: refs.current.radios2,
                      value: 'two',
                    },
                    {
                      id: 'demo-radio-group3',
                      label: 'Super fantastic label three',
                      ref: refs.current.radios3,
                      value: 'three',
                    },
                  ]}
                  size={state.size}
                  value={values.radios}
                />
              </Rhythm>
              <Rhythm mb={2} mt={4}>
                <Slider
                  contrast={contrast}
                  formatValue={value => value + '%'}
                  max={100}
                  min={0}
                  name="slider"
                  onChange={(event, value) => setValues({ ...values, slider: value })}
                  persistEvents={persistEvents}
                  ref={e => {
                    refs.current.slider = e;
                  }}
                  value={values.slider}
                  valuePosition="top"
                  width="100%"
                >
                  Percentage
                </Slider>
              </Rhythm>
              <Flex wrap alignItems="center" justifyContent="space-between">
                <Toggle
                  checked={values.toggle}
                  contrast={contrast}
                  name="toggle"
                  onChange={(event, checked) => setValues({ ...values, toggle: checked })}
                  persistEvents={persistEvents}
                  ref={e => {
                    refs.current.toggle = e;
                  }}
                  value={true}
                >
                  Activate super powers
                </Toggle>
                <Rhythm mr={-2}>
                  <Flex flexible alignItems="center" justifyContent="flex-end">
                    <Rhythm mr={2} my={1}>
                      <Button color="neutral" shape="brick" weight="ghost">
                        Cancel
                      </Button>
                      <Button color="primary" onClick={() => console.log(refs.current)} shape="brick" type="submit">
                        Submit
                      </Button>
                    </Rhythm>
                  </Flex>
                </Rhythm>
              </Flex>
            </React.Fragment>
          )}
        </FormDemo>
      </Rhythm>
    )}
  </StateWrapper>
</Canvas>
